---
jupyter: python3
---

##Tarea 8.5

```{python}
#| colab: {base_uri: https://localhost:8080/}
import numpy as np

# Datos
sigma = np.array([0.75, 0.77, 0.79, 0.81, 0.83])
n = np.array([1.1324, 1.1376, 1.1386, 1.1454, 1.1474]) * 1e-3

# Paso
h = sigma[1] - sigma[0]

# 1) Derivada centrada en σ = 0.79 (índice 2)
n_prime = (n[3] - n[1]) / (2*h)

# 2) Tercera derivada con fórmula de cinco puntos
# n'''(σ0) ≈ [ -0.5 f(x+2h) + f(x+h) - f(x-h) + 0.5 f(x-2h) ] / h^3
# Faltó deducir esta fórmula
n3 = (-0.5*n[4] + n[3] - n[1] + 0.5*n[0]) / (h**3)

# 3) Error de truncamiento
err_trunc = abs((h**2 / 6) * n3)

# 4) Error por ruido
delta_n = 1e-6
err_noise = delta_n / h

# 5) Paso óptimo
h_opt = (3*delta_n / abs(n3))**(1/3)

# 6) Resultados
print("Derivada estimada n'(0.79) = {:.3e}".format(n_prime))
print("Tercera derivada estimada n'''(0.79) = {:.3e}".format(n3))
print("Error de truncamiento ≈ {:.3e}".format(err_trunc))
print("Error por ruido ≈ {:.3e}".format(err_noise))
print("Paso óptimo h_opt ≈ {:.3f}".format(h_opt))

# Comentario sobre el paso
if h < h_opt:
    print("→ El paso h=%.2f es más pequeño que el óptimo: conviene usar un paso MAYOR." % h)
else:
    print("→ El paso h=%.2f es adecuado o podría reducirse ligeramente." % h)
```

## Nota: 6.0

Faltó concluir e interpretar. Faltó deducir la fórmula de 5 puntos.
